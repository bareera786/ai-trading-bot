# COPILOT HARD RULES — AI TRADING BOT

You are a coding assistant working on an EXISTING trading bot.
Your goal is to FINISH the project, not redesign, optimize, or extend it.

You MUST preserve current behavior unless explicitly told otherwise.

---

## ABSOLUTE RULES (MUST FOLLOW)

1. DO NOT add new features.
2. DO NOT refactor unrelated code.
3. DO NOT change architecture or data flow.
4. DO NOT add new strategies.
5. DO NOT add new models or indicators.
6. DO NOT rename files, classes, or functions.
7. DO NOT change persistence paths or schemas.
8. DO NOT change execution order or trading lifecycle.
9. DO NOT touch UI unless explicitly instructed.
10. DO NOT invent new APIs or endpoints.

---

## WHAT YOU ARE ALLOWED TO DO

1. Fix bugs that PREVENT trading from working.
2. Make trading execute correctly using EXISTING logic only.
3. Add logs ONLY at points where execution is broken.
4. Add or adjust tests ONLY to verify trading correctness.
5. Fix persistence bugs that prevent state from being saved or loaded.
6. Fix calculation errors (PnL, quantity, balance) using EXISTING data.
7. Make the bot reach a **first fully correct trade lifecycle** (paper or live).

---

## TRADING DEFINITION OF DONE

Trading is considered WORKING only if ALL of the following are true:

- Orders are created
- Orders are submitted
- Orders are filled or correctly rejected
- Positions open and close correctly
- PnL is calculated from REAL exchange data
- State persists correctly (bot_state.json)
- No crashes during a 24h simulation run

If a task does NOT directly move toward this goal — DO NOT DO IT.

---

## DEBUGGING METHOD (MANDATORY)

When trading is broken, follow this EXACT order:

1. Signal generation
2. Order creation
3. Order submission
4. Order fill / confirmation
5. Position tracking
6. Exit execution
7. PnL calculation

STOP at the FIRST broken step.
Fix ONLY that step.
DO NOT continue past it.

---

## RESPONSE RULES

- Always state WHICH step is broken.
- Always explain WHAT is failing.
- Always explain WHY it fails.
- Always propose the MINIMAL fix.
- NEVER suggest rewrites or redesigns.
- If unsure, ask ONE clarifying question and STOP.

---

# UI / DASHBOARD / RIBS RULES (FRONTEND ONLY)

These rules apply ONLY when explicitly instructed to work on UI, dashboards, or visualizations.

- UI work is READ-ONLY.
- DO NOT modify trading logic, execution code, or persistence.
- DO NOT modify RIBS calculations or thresholds.
- DO NOT modify backend APIs unless explicitly approved.
- UI must consume EXISTING backend data only.
- No new backend endpoints.
- No schema changes.
- No strategy behavior changes.
- If UI requires backend change → STOP and ask for approval.

---

# TRADING SCOPE — FROZEN

- Strategy: EXISTING strategy only
- Exchange: EXISTING exchange configuration
- Mode: Paper trading OR Live (unchanged)
- Timeframe: As currently configured

- No new indicators
- No new ML models
- No optimizations

GOAL:
ONE stable strategy that correctly places, fills, closes trades, and computes PnL.

---

ACKNOWLEDGE THESE RULES BEFORE MAKING ANY CHANGE.
